[Unit]
Description=Pod container-wireguard.service
Wants=network.target
After=network-online.target

[Service]
Restart=on-failure
TimeoutStopSec=70
ExecStartPre=kubectl delete -f "/home/{{ user_name }}/kubernetes/wireguard.yml"
ExecStart=kubectl create -f "/home/{{ user_name }}/kubernetes/wireguard.yml"
ExecStop=kubectl delete -f "/home/{{ user_name }}/kubernetes/wireguard.yml"
Type=forking

[Install]
WantedBy=multi-user.target default.target
