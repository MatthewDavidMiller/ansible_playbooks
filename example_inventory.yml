all:
  vars:
    locale: "en_US.UTF-8"
  children:
    homelab:
      vars:
        # Global variables
        ansible_become: yes
        ansible_become_method: sudo
        # Device variables
        default_interface: "example_interface"
        docker_username: "example_username"
        nextcloud_webdav_path: "https://example.nextcloud.com/remote.php/dav/files/user"
        ip_ansible: "192.168.1.1/32"
        management_network: "192.168.1.0/24"
        user_name: "example_user"
        docker_password: "example_password"
        porkbun_api_key: "example_api_key"
        porkbun_api_key_secret: "example_api_key_secret"
        top_domain: "example.com"
        swag_path: "/example_path"
        swag_dns_plugin: "example_plugin"
        nextcloud_dns_name: "example.nextcloud.com"
        nextcloud_rclone_user: "example_user"
        nextcloud_webdav_user: "example_user"
        nextcloud_rclone_pass: "example_pass"
        nextcloud_webdav_pass: "example_pass"
        patching_weekday: 1
        patching_hour: 12
        patching_minute: 30
        patching_month: "1"

        container_patching_weekday: 5
        container_patching_hour: 3
        container_patching_minute: 45
        container_patching_month: "12"

      hosts:
        vpn:
          ansible_host: vpn.example.com
          # Device variables
          user_name: "user1,user2,user3"
          vpn_path: /path/to/vpn
          homelab_domain: "example.com"
          homelab_subdomain: "example"
          listen_port: "1194"
          wireguard_dns_server: "192.168.1.1"
          wireguard_server_network_prefix: "10.0.0.0/24"
          wireguard_allowed_ips: "192.168.1.0/24, 10.0.0.1/32"

        unificontroller:
          ansible_host: unificontroller.example.com
          # Device variables
          unificontroller_path: "/path/to/unifi"
          swag_network: "example_network"
          swag_host_domain: "example.internal"
          swag_requires: "example_service"
          proxy_config:
            - name: "example_config"
              proxy_fqdn: "proxy.example.com"
              container_destination: "example.dns.podman"

          default_server_name: "example_server"
          default_app_name: "example_app"
          container_service_names: "service1"

        vm1:
          ansible_host: 192.168.1.X  # Replace with vm1's actual IP
          # SWAG — list of all container networks to join (backward-compatible; single-service hosts use scalar swag_network instead)
          swag_networks:
            - nextcloud_container_net
            - navidrome_container_net
            - vaultwarden_container_net
            - semaphore_container_net
          swag_path: /path/to/swag
          swag_dns_plugin: porkbun
          swag_host_domain: "nextcloud,paperless,navidrome,vault,semaphore"
          proxy_config:
            - name: nextcloud_proxy
              proxy_fqdn: "nextcloud.example.com"
              proxy_upstream_port: "80"
              proxy_upstream_protocol: "http"
              container_destination: "nextcloud.dns.podman"
            - name: paperless_ngx_proxy
              proxy_fqdn: "paperless.example.com"
              proxy_upstream_port: "8000"
              proxy_upstream_protocol: "http"
              container_destination: "paperless.dns.podman"
            - name: navidrome_proxy
              proxy_fqdn: "navidrome.example.com"
              proxy_upstream_port: "4533"
              proxy_upstream_protocol: "http"
              container_destination: "navidrome.dns.podman"
            - name: vaultwarden_proxy
              proxy_fqdn: "vault.example.com"
              proxy_upstream_port: "80"
              proxy_upstream_protocol: "http"
              container_destination: "vaultwarden.dns.podman"
            - name: semaphore_proxy
              proxy_fqdn: "semaphore.example.com"
              proxy_upstream_port: "3000"
              proxy_upstream_protocol: "http"
              container_destination: "semaphore.dns.podman"

          # Nextcloud + Paperless NGX (share PostgreSQL 15 + Redis)
          postgres_path: /path/to/postgres_nextcloud
          nextcloud_path: /path/to/nextcloud
          nextcloud_disk: "UUID=example-uuid"
          nextcloud_borg_backup_path: /path/to/nextcloud/borg/backup
          nextcloud_paperless_backup_location: Nextcloud:backup/nextcloud
          nextcloud_database_name: nextcloud
          nextcloud_database_user: nextcloud_user
          nextcloud_database_user_password: example_password
          nextcloud_admin_user: admin
          nextcloud_admin_password: example_password
          nextcloud_trusted_domains: nextcloud.example.com
          nextcloud_dns_name: nextcloud.example.com

          paperless_data_path: /path/to/paperless/data
          paperless_media_path: /path/to/paperless/media
          paperless_export_path: /path/to/paperless/export
          paperless_consume_path: /path/to/paperless/consume
          paperless_database_name: paperless
          paperless_database_user: paperless_user
          paperless_database_user_password: example_password
          paperless_dns_name: paperless.example.com

          # Semaphore (PostgreSQL 17 — uses semaphore_postgres_path, NOT postgres_path)
          semaphore_postgres_path: /path/to/postgres_semaphore
          semaphore_database_name: semaphore
          semaphore_database_user: semaphore_user
          semaphore_database_user_password: example_password
          semaphore_admin_name: admin
          semaphore_admin_email: admin@example.com
          semaphore_admin_password: example_password
          semaphore_encryption_key: example_32_char_encryption_key_xx

          # Navidrome
          navidrome_path: /path/to/navidrome
          navidrome_backup_location: Nextcloud:navidrome_backup
          # Local music path: bind-mount Nextcloud's on-disk Music folder directly (bypasses rclone FUSE)
          navidrome_local_music_path: /path/to/nextcloud/data/<username>/files/Music

          # Vaultwarden
          vaultwarden_path: /path/to/vaultwarden
          vaultwarden_backup_location: Nextcloud:vaultwarden_backup

          # Semaphore backup
          semaphore_backup_location: Nextcloud:semaphore_backup

          # Systemd dependency ordering for SWAG service unit After= directive
          container_service_names: "postgres_container redis_container nextcloud_container paperless_ngx navidrome_container vaultwarden semaphore_postgres semaphore"

          # Borg backup to second NVMe disk (local — Nextcloud runs on this host)
          borg_backup_path: /path/to/borg_backup
          backup_disk: "UUID=example-uuid-backup-disk"
          backup_local: true

          # Firewall — allow Borg backup traffic from backup server
          backup_host: "192.168.1.50/32"
