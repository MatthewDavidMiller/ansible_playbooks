---
# https://borgbackup.readthedocs.io/en/stable/quickstart.html

- name: Install Borg Backup
  ansible.builtin.apt:
    name: borgbackup
    state: present
  when: ansible_facts['distribution'] == 'Debian'

- name: Backup Script
  ansible.builtin.template:
    src: backup_files.sh.j2
    dest: "/usr/local/bin/backup_files.sh"
  when: ansible_facts['distribution'] == 'Debian'

- name: Backup Daily
  ansible.builtin.cron:
    name: "Borg Backup"
    special_time: daily
    job: /usr/bin/bash /usr/local/bin/backup_files.sh
  when: ansible_facts['distribution'] == 'Debian'
