---
- name: Clean dnf package cache
  ansible.builtin.command: dnf clean all
  become: true

- name: Remove orphaned packages
  ansible.builtin.dnf:
    autoremove: yes
  become: true

- name: Remove log files older than 30 days
  ansible.builtin.command: find /var/log -name "*.log" -type f -mtime +30 -delete
  become: true

- name: Vacuum systemd journal logs (keep last 2 weeks)
  ansible.builtin.command: journalctl --vacuum-time=2weeks
  become: true

- name: Prune unused Podman images
  ansible.builtin.command: podman image prune -f
  become: true
  ignore_errors: yes

- name: Prune stopped Podman containers
  ansible.builtin.command: podman container prune -f
  become: true
  ignore_errors: yes

- name: Prune unused Podman volumes
  ansible.builtin.command: podman volume prune -f
  become: true
  ignore_errors: yes

- name: Prune unused Podman networks
  ansible.builtin.command: podman network prune -f
  become: true
  ignore_errors: yes
